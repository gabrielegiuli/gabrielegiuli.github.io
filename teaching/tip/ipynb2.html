<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> 2. Ponderomotive Force | Gabriele Johannes Giuli </title> <meta name="author" content="Gabriele Johannes Giuli"> <meta name="description" content="In this notebook we explore the fast and slow confining dynamics of a RF Paul trap."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://gabrielegiuli.github.io/teaching/tip/ipynb2"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Gabriele</span> Johannes Giuli </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item active"> <a class="nav-link" href="/teaching/">Teaching <span class="sr-only">(current)</span> </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">2. Ponderomotive Force</h1> <p class="post-description">In this notebook we explore the fast and slow confining dynamics of a RF Paul trap.</p> </header> <article> <p><a class="btn btn-primary" href="/assets/jupyter/tip/ponderomotive_force.zip" download=""> 💾 Download Notebook </a></p> <hr> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">sympy</span> <span class="k">as</span> <span class="n">sp</span>
<span class="kn">from</span> <span class="n">sympy.vector</span> <span class="kn">import</span> <span class="n">CoordSys3D</span><span class="p">,</span> <span class="n">gradient</span>
<span class="kn">from</span> <span class="n">matplotlib.animation</span> <span class="kn">import</span> <span class="n">FuncAnimation</span>
<span class="kn">from</span> <span class="n">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
</code></pre></div></div> <h1 id="trapping-an-ion">Trapping an Ion</h1> <p>Let’s see if we can trap an ion with static fields only. To this end, let’s consider the electric potential, defined as \(\vec{E} = -\nabla\varphi.\)</p> <p>We now consider Maxwell’s equation for the divergence of the electric field, in the absence of charges, namely \(\nabla \cdot \vec{E} = 0,\) and we substitute for $\vec{E}$. Therefore we obtain \(\nabla \cdot (-\nabla\varphi) = \nabla^2\varphi = 0.\) If we were to expand the laplacian of the electric potential, we would find the following form: \(\frac{\partial^2\varphi}{\partial x^2} + \frac{\partial^2\varphi}{\partial y^2} + \frac{\partial^2\varphi}{\partial z^2} = 0.\) Therefore, we see that the curvature (and thereofore the confinement) of the potential cannot be of the same sign in the three spatial directions. Therefore, if we want to confine our particle - therefore wanting all three second derivatives to be greeater than zero, we would not be able to do so with a static field.</p> <h2 id="paul-trap">Paul Trap</h2> <p>One way to get around this limitation is to use the <em>Paul Trap</em> architecture. In a Paul (or RF) trap we confine the ions in the axial direction with a simple quadratic potential given by a capacitor, namely \(\varphi_\mathrm{axial}(z) = \varphi_{0,z} z^2.\) Since we are not able to confine in all three directions, the best we can do is to create a quadrupole potential in the radial direction \(\varphi_\mathrm{radial}(x, y) = \varphi_{0,r} (x^2 - y^2).\) Note that the total potential seen by the ion will be given by \(\varphi(x,y,z) = \varphi_\mathrm{axial}(z) + \varphi_\mathrm{radia}(x, y).\) Since we established that we will be able to trap in the axial direction, let us concentrate on the radial motion. The first thing that we do is to find the field components:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">phi_0</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="nf">symbols</span><span class="p">(</span><span class="sh">'</span><span class="s">phi_0 phi</span><span class="sh">'</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="nc">CoordSys3D</span><span class="p">(</span><span class="sh">'</span><span class="s">N</span><span class="sh">'</span><span class="p">)</span>

<span class="n">phi</span> <span class="o">=</span> <span class="n">phi_0</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="p">.</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">N</span><span class="p">.</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">E</span> <span class="o">=</span> <span class="o">-</span><span class="nf">gradient</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

<span class="n">potential_2d</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="nf">lambdify</span><span class="p">([</span><span class="n">N</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">],</span> <span class="n">phi</span><span class="p">,</span> <span class="sh">'</span><span class="s">numpy</span><span class="sh">'</span><span class="p">)</span>
<span class="n">field_2d_x</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="nf">lambdify</span><span class="p">([</span><span class="n">N</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">],</span> <span class="n">E</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">N</span><span class="p">.</span><span class="n">i</span><span class="p">))</span>
<span class="n">field_2d_y</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="nf">lambdify</span><span class="p">([</span><span class="n">N</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">],</span> <span class="n">E</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">N</span><span class="p">.</span><span class="n">j</span><span class="p">))</span>

<span class="n">E</span>
</code></pre></div></div> \[\displaystyle \left(- 2 \mathbf{x_N} \phi_{0}\right)\mathbf{\hat{i}_N} + \left(2 \mathbf{y_N} \phi_{0}\right)\mathbf{\hat{j}_N}\] <p>We also plot the potential in the radial directions. We expect to see a saddle!</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">phi_mesh</span> <span class="o">=</span> <span class="nf">potential_2d</span><span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">projection</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">3d</span><span class="sh">"</span><span class="p">})</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot_surface</span><span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">,</span> <span class="n">phi_mesh</span><span class="p">)</span>
</code></pre></div></div> <p><img src="/assets/img/teaching/tip/week3_4_1.png" alt="png"></p> <p>We can also plot the resulting field, and thus force imparted from the ion. On the same plot we will show the potential as a colour plot, and the field as a quiver plot.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">field_x_mesh</span> <span class="o">=</span> <span class="nf">field_2d_x</span><span class="p">(</span><span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">field_y_mesh</span> <span class="o">=</span> <span class="nf">field_2d_y</span><span class="p">(</span><span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">pcolor</span><span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">,</span> <span class="n">phi_mesh</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">quiver</span><span class="p">(</span><span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span><span class="p">,</span> <span class="n">field_x_mesh</span><span class="p">,</span> <span class="n">field_y_mesh</span><span class="p">)</span>
</code></pre></div></div> <p><img src="/assets/img/teaching/tip/week3_6_1.png" alt="png"></p> <p>All is looking nice and colorful, but we still have the issue that our static traps only confines along $z$ and $x$. This can be seen by the convergence of the field-lines along the $x$-direction and the divergence along the $y$-direction.</p> <p>The key to solving this issue is to quickly switching confinement and anti-confinement among the two radial directions. In this way, the radial potential becomes \(\varphi_\mathrm{radial}(x, y, t) = \varphi_{0,r} \cos(\omega_\text{RF}t)(x^2 - y^2).\)</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">theta</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="nf">symbols</span><span class="p">(</span><span class="sh">'</span><span class="s">theta</span><span class="sh">'</span><span class="p">)</span>
<span class="n">phi_t</span> <span class="o">=</span> <span class="n">phi</span><span class="p">.</span><span class="nf">subs</span><span class="p">(</span><span class="n">phi_0</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="n">E_t</span> <span class="o">=</span> <span class="o">-</span><span class="nf">gradient</span><span class="p">(</span><span class="n">phi_t</span><span class="p">)</span>

<span class="n">potential_2d_t</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="nf">lambdify</span><span class="p">([</span><span class="n">N</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">],</span> <span class="n">phi_t</span><span class="p">)</span>
<span class="n">field_2d_x_t</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="nf">lambdify</span><span class="p">([</span><span class="n">N</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">],</span> <span class="n">E_t</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">N</span><span class="p">.</span><span class="n">i</span><span class="p">))</span>
<span class="n">field_2d_y_t</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="nf">lambdify</span><span class="p">([</span><span class="n">N</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">],</span> <span class="n">E_t</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">N</span><span class="p">.</span><span class="n">j</span><span class="p">))</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tot_frames</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">phi_mesh</span> <span class="o">=</span> <span class="nf">potential_2d_t</span><span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">field_x_mesh</span> <span class="o">=</span> <span class="nf">field_2d_x_t</span><span class="p">(</span><span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">field_y_mesh</span> <span class="o">=</span> <span class="nf">field_2d_y_t</span><span class="p">(</span><span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">pcolor_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">pcolor</span><span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">,</span> <span class="n">phi_mesh</span><span class="p">)</span>
<span class="n">quiver</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">quiver</span><span class="p">(</span><span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span><span class="p">,</span> <span class="n">field_x_mesh</span><span class="p">,</span> <span class="n">field_y_mesh</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="o">/</span><span class="n">tot_frames</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">frame</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">phi_mesh</span> <span class="o">=</span> <span class="nf">potential_2d_t</span><span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
    <span class="n">field_x_mesh</span> <span class="o">=</span> <span class="nf">field_2d_x_t</span><span class="p">(</span><span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
    <span class="n">field_y_mesh</span> <span class="o">=</span> <span class="nf">field_2d_y_t</span><span class="p">(</span><span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
    
    <span class="n">pcolor_plot</span><span class="p">.</span><span class="nf">set_array</span><span class="p">(</span><span class="n">phi_mesh</span><span class="p">.</span><span class="nf">flatten</span><span class="p">())</span>
    <span class="n">quiver</span><span class="p">.</span><span class="nf">set_UVC</span><span class="p">(</span><span class="n">field_x_mesh</span><span class="p">,</span> <span class="n">field_y_mesh</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">pcolor_plot</span><span class="p">,</span>

<span class="n">ani</span> <span class="o">=</span> <span class="nc">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tot_frames</span><span class="p">),</span> <span class="n">blit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ani</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="sh">'</span><span class="s">../output/vector_field_animation.gif</span><span class="sh">'</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="sh">'</span><span class="s">pillow</span><span class="sh">'</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</code></pre></div></div> <p><img src="/assets/img/teaching/tip/week3_9_0.gif" alt="png"></p> <p>Look how the confinement and anti-confinement are swapped as time passes by. As long as you create the correct folder, you can save the animation gif in case you have the irresistible urge to share this with your friends.</p> <h2 id="adding-the-ion">Adding the Ion</h2> <p>Let us now solve for the motion of the ion. It should be somewhat intuitive that, as ling as $\omega_\text{RF}$ is fast enough when compared with the ion’s dynamics, we should be able to trap the ion. Let’s see the movement of the ion in the Paul trap. Here we will plot its $x$ and $y$ coordinate as time passes by.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">qm</span><span class="p">):</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">state</span>
    <span class="n">ddx</span> <span class="o">=</span> <span class="n">qm</span><span class="o">*</span><span class="nf">field_2d_x_t</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
    <span class="n">ddy</span> <span class="o">=</span> <span class="n">qm</span><span class="o">*</span><span class="nf">field_2d_y_t</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">ddx</span><span class="p">,</span> <span class="n">ddy</span><span class="p">]</span>

<span class="n">f</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">qm</span> <span class="o">=</span> <span class="mi">80</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">30000</span><span class="p">)</span>
<span class="n">ic</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.707</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">sol1</span> <span class="o">=</span> <span class="nf">odeint</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ic</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">qm</span><span class="p">))</span>
<span class="n">ic</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">sol2</span> <span class="o">=</span> <span class="nf">odeint</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ic</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">qm</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">sol1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sol1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">x2</span> <span class="o">=</span> <span class="n">sol2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">sol2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></div> <p><img src="/assets/img/teaching/tip/week3_11_1.png" alt="png"></p> <p>You see that we have two types of motion:</p> <ol> <li>The slow-frequency oscillations are called the <em>secular</em> motion;</li> <li>while the low-amplitude and high-frequency oscillations are called <em>micromotion</em> and are due to the RF drive. Note that micromotion is often unwanted. Now let’s try to visualize what is going on in a single plot.</li> </ol> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">downsample_factor</span> <span class="o">=</span> <span class="mi">30</span>

<span class="n">time_downsampled</span> <span class="o">=</span> <span class="n">t</span><span class="p">[::</span><span class="n">downsample_factor</span><span class="p">]</span>
<span class="n">x_p_downsampled</span> <span class="o">=</span> <span class="n">x</span><span class="p">[::</span><span class="n">downsample_factor</span><span class="p">]</span>
<span class="n">y_p_downsampled</span> <span class="o">=</span> <span class="n">y</span><span class="p">[::</span><span class="n">downsample_factor</span><span class="p">]</span>

<span class="n">x_p_downsampled2</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[::</span><span class="n">downsample_factor</span><span class="p">]</span>
<span class="n">y_p_downsampled2</span> <span class="o">=</span> <span class="n">y2</span><span class="p">[::</span><span class="n">downsample_factor</span><span class="p">]</span>

<span class="n">phi_mesh</span> <span class="o">=</span> <span class="nf">potential_2d_t</span><span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">field_x_mesh</span> <span class="o">=</span> <span class="nf">field_2d_x_t</span><span class="p">(</span><span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">field_y_mesh</span> <span class="o">=</span> <span class="nf">field_2d_y_t</span><span class="p">(</span><span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">pcolor_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">pcolor</span><span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">,</span> <span class="n">phi_mesh</span><span class="p">)</span>
<span class="n">quiver</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">quiver</span><span class="p">(</span><span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span><span class="p">,</span> <span class="n">field_x_mesh</span><span class="p">,</span> <span class="n">field_y_mesh</span><span class="p">)</span>

<span class="n">point</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x_p_downsampled</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_p_downsampled</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="sh">'</span><span class="s">ro</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">marker only</span><span class="sh">'</span><span class="p">)</span>
<span class="n">trace</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="sh">'</span><span class="s">r-</span><span class="sh">'</span><span class="p">)</span>

<span class="n">point2</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x_p_downsampled2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_p_downsampled2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="sh">'</span><span class="s">yo</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">marker only</span><span class="sh">'</span><span class="p">)</span>
<span class="n">trace2</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="sh">'</span><span class="s">y-</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">t = </span><span class="si">{</span><span class="n">time_downsampled</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> s</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">time_downsampled</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f</span>

    <span class="n">phi_mesh</span> <span class="o">=</span> <span class="nf">potential_2d_t</span><span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
    <span class="n">field_x_mesh</span> <span class="o">=</span> <span class="nf">field_2d_x_t</span><span class="p">(</span><span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
    <span class="n">field_y_mesh</span> <span class="o">=</span> <span class="nf">field_2d_y_t</span><span class="p">(</span><span class="n">x_mesh_q</span><span class="p">,</span> <span class="n">y_mesh_q</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>

    <span class="n">sub_x</span> <span class="o">=</span> <span class="n">x_p_downsampled</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">frame</span><span class="p">]</span>
    <span class="n">sub_y</span> <span class="o">=</span> <span class="n">y_p_downsampled</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">frame</span><span class="p">]</span>

    <span class="n">sub_x2</span> <span class="o">=</span> <span class="n">x_p_downsampled2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">frame</span><span class="p">]</span>
    <span class="n">sub_y2</span> <span class="o">=</span> <span class="n">y_p_downsampled2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">frame</span><span class="p">]</span>
    
    <span class="n">pcolor_plot</span><span class="p">.</span><span class="nf">set_array</span><span class="p">(</span><span class="n">phi_mesh</span><span class="p">.</span><span class="nf">flatten</span><span class="p">())</span>
    <span class="n">quiver</span><span class="p">.</span><span class="nf">set_UVC</span><span class="p">(</span><span class="n">field_x_mesh</span><span class="p">,</span> <span class="n">field_y_mesh</span><span class="p">)</span>

    <span class="n">point</span><span class="p">.</span><span class="nf">set_data</span><span class="p">([</span><span class="n">x_p_downsampled</span><span class="p">[</span><span class="n">frame</span><span class="p">]],</span> <span class="p">[</span><span class="n">y_p_downsampled</span><span class="p">[</span><span class="n">frame</span><span class="p">]])</span>
    <span class="n">trace</span><span class="p">.</span><span class="nf">set_data</span><span class="p">(</span><span class="n">sub_x</span><span class="p">,</span> <span class="n">sub_y</span><span class="p">)</span>

    <span class="n">point2</span><span class="p">.</span><span class="nf">set_data</span><span class="p">([</span><span class="n">x_p_downsampled2</span><span class="p">[</span><span class="n">frame</span><span class="p">]],</span> <span class="p">[</span><span class="n">y_p_downsampled2</span><span class="p">[</span><span class="n">frame</span><span class="p">]])</span>
    <span class="n">trace2</span><span class="p">.</span><span class="nf">set_data</span><span class="p">(</span><span class="n">sub_x2</span><span class="p">,</span> <span class="n">sub_y2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pcolor_plot</span><span class="p">,</span>

<span class="n">ani</span> <span class="o">=</span> <span class="nc">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">time_downsampled</span><span class="p">)),</span> <span class="n">blit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ani</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="sh">'</span><span class="s">../output/particle_motion.gif</span><span class="sh">'</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="sh">'</span><span class="s">pillow</span><span class="sh">'</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</code></pre></div></div> <p><img src="/assets/img/teaching/tip/week3_13_0.gif" alt="png"></p> <p>Have a look how important micormotion is to the “formation” of the pseudopotential. Keep an eye on the two particles and see how the probing of the field due to micromotion ensures that the two particles exhibit the same secular motion.</p> <p>Now try to change the parameters until you cannot trap anymore.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Gabriele Johannes Giuli. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>